<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>runbms - running-ng Documentation</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../intro.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../install.html"><strong aria-hidden="true">1.1.</strong> Installation</a></li></ol></li><li class="chapter-item expanded "><a href="../quickstart.html"><strong aria-hidden="true">2.</strong> Quickstart</a></li><li class="chapter-item expanded "><a href="../basics/index.html"><strong aria-hidden="true">3.</strong> Basics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basics/design.html"><strong aria-hidden="true">3.1.</strong> Design Principles</a></li></ol></li><li class="chapter-item expanded "><a href="../references/index.html"><strong aria-hidden="true">4.</strong> Core References</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../references/suite.html"><strong aria-hidden="true">4.1.</strong> Benchmark Suite</a></li><li class="chapter-item expanded "><a href="../references/runtime.html"><strong aria-hidden="true">4.2.</strong> Runtime</a></li><li class="chapter-item expanded "><a href="../references/modifier.html"><strong aria-hidden="true">4.3.</strong> Modifier</a></li></ol></li><li class="chapter-item expanded "><a href="../commands/index.html"><strong aria-hidden="true">5.</strong> Command References</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../commands/runbms.html" class="active"><strong aria-hidden="true">5.1.</strong> runbms</a></li><li class="chapter-item expanded "><a href="../commands/minheap.html"><strong aria-hidden="true">5.2.</strong> minheap</a></li><li class="chapter-item expanded "><a href="../commands/fillin.html"><strong aria-hidden="true">5.3.</strong> fillin</a></li></ol></li><li class="chapter-item expanded "><a href="../cookbook/index.html"><strong aria-hidden="true">6.</strong> Cookbook</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cookbook/perf_events.html"><strong aria-hidden="true">6.1.</strong> Performance Event Monitoring</a></li></ol></li><li class="chapter-item expanded "><a href="../faq.html"><strong aria-hidden="true">7.</strong> Frequently Asked Questions</a></li><li class="chapter-item expanded "><a href="../changelog.html"><strong aria-hidden="true">8.</strong> Changelog</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">running-ng Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="runbms"><a class="header" href="#runbms"><code>runbms</code></a></h1>
<p>This subcommand runs benchmarks with different configs, possibly with varying heap sizes.</p>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<pre><code class="language-console">runbms [-h|--help] [-i|--invocations INVOCATIONS] [-s|--slice SLICE] [-p|--id-prefix ID_PREFIX] [-m|--minheap-multiplier MINHEAP_MULTIPLIER] [--skip-oom SKIP_OOM] [--skip-timeout SKIP_TIMEOUT] [--resume RESUME] [--workdir WORKDIR] LOG_DIR CONFIG [N] [n [n ...]]
</code></pre>
<p><code>-h</code>: print help message.</p>
<p><code>-i</code>: set the number of invocations.
Overrides <code>invocations</code> in the config file.</p>
<p><code>-s</code>: only use the specified heap sizes.
This is a comma-separated string of integers or floating point numbers.
For each slice <code>s</code> in <code>SLICE</code>, we run benchmarks at <code>s * minheap</code>.
<code>N</code> and <code>n</code>s are ignored. </p>
<p><code>-p</code>: add a prefix to the folder names where the results are stored.
By default, the folder that stores the result is named using the host name and the timestamp.
However, you can add a prefix to the folder name to signify which experiments the results belong to.</p>
<p><code>-m</code> (preview ⚠️): multiple the minheap value for each benchmark by <code>MINHEAP_MULTIPLIER</code>.
Do <strong>NOT</strong> use this unless you know what you are doing.
Override <code>minheap_multiplier</code> in the config file.</p>
<p><code>--skip-oom</code> (preview ⚠️): skip the remaining invocations if a benchmark under a <code>config</code> has run out of memory more than <code>SKIP_OOM</code> times.</p>
<p><code>--skip-timeout</code> (preview ⚠️): skip the remaining invocations if a benchmark under a <code>config</code>  has timed out more than <code>SKIP_TIMEOUT</code> times.</p>
<p><code>--resume</code> (preview ⚠️): resume a previous run under <code>LOG_DIR/RESUME</code>. If a <code>.log.gz</code> already exists for a group of invocations, they will be skipped. Remember to clean up the partial <code>*.log</code> files before resuming.</p>
<p><code>--workdir</code> (preview ⚠️): use the specified directory as the working directory for benchmarks.
If not specified, a temporary directory will be created under an OS-dependent location with a <code>runbms-</code> prefix.</p>
<p><code>LOG_DIR</code>: where to store the results.
This is required.</p>
<p><code>CONFIG</code>: the path to the configuration file.
This is required.</p>
<p><code>N</code>: the number of different heap sizes to explore.
Must be powers of two.
Explore heap sizes denoted by 0, 1, ..., and <code>N</code> (<code>N + 1</code> different sizes in total).
The heap size 0 represents <code>1.0 * minheap</code>, and the heap size <code>N</code> represents <code>heap_range * minheap</code> (by default, <code>6.0 * minheap</code>).
If <code>N</code> is omitted, then the script will run benchmarks without explicit explicitly setting heap sizes, unless you specify <code>-s</code> or use a modifier that sets the heap size.</p>
<p><code>n</code>: the heap sizes to explore.
Instead of exploring 0, 1, ..., and <code>N</code>, only explore the <code>n</code>s specified.</p>
<h2 id="keys"><a class="header" href="#keys">Keys</a></h2>
<p><code>invocations</code>: see above.</p>
<p><code>minheap_multiplier</code>: see above.</p>
<p><code>heap_range</code>: the heap size relative to the minheap when <code>n = N</code>.</p>
<p><code>spread_factor</code>: changes how 0, 1, ..., and <code>N</code> are spread out.
When <code>spread_factor</code> is zero, the differences between 0, 1, ..., and <code>N</code> are the same.
The larger the <code>spread_factor</code> is, the coarser the spacing is at the end relative to start.
Please do <strong>NOT</strong> change this unless you understand how it works.</p>
<p><code>remote_host</code>: the remote host to <code>rsync</code> the results to.
The exact absolute path of <code>LOG_DIR</code> is used on both the local and the remote machine.</p>
<p><code>plugins</code> (preview ⚠️): plugins of this command.
Must be a dictionary, similar to how modifiers are declared.</p>
<h2 id="plugins-preview-"><a class="header" href="#plugins-preview-">Plugins (preview ⚠️)</a></h2>
<h3 id="zulip"><a class="header" href="#zulip"><code>Zulip</code></a></h3>
<p>Zulip integration for notifying when experiments start or end.
No message will be sent if it'a dry run.</p>
<p>Here is an example.</p>
<pre><code class="language-yaml">plugins:
  zulip:
    type: Zulip
    request:
      type: private
      to: [&quot;your user id here&quot;]
</code></pre>
<h4 id="keys-1"><a class="header" href="#keys-1">Keys</a></h4>
<p><code>request</code>: please follow the <a href="https://zulip.com/api/send-message">Zulip API documentation</a>.
Note that you don't need to put in <code>content</code> here.
Please contact the administrators of your organization for your user ID.
If you use a bot user and want to post to a channel, please <a href="https://github.com/zulip/zulip/issues/13658#issuecomment-573959765">subscribe the bot user to the channel so that messages can be edited</a>.</p>
<p><code>config_file</code>: an optional string to the path of config file.
If not specified, the default is <code>~/.zuliprc</code>.
Please make sure that this file can only be accessed by you (e.g., <code>chmod 600 ~/.zulip</code>).
If you are a moma user, please create this file on <code>squirrel</code>, and it will then be synced to other machines.
Please follow the Zulip documentation for the <a href="https://zulip.com/api/configuring-python-bindings">syntax</a> of the config file and for <a href="https://zulip.com/api/api-keys">obtaining an API key</a>.
If you can't create a new bot, please contact the administrators of your organization.</p>
<h3 id="copyfile"><a class="header" href="#copyfile"><code>CopyFile</code></a></h3>
<p>Copying files from the working directory.</p>
<p>Here is an example.</p>
<pre><code class="language-yaml">plugins:
  dacapo_latency:
    type: CopyFile
    patterns:
      - &quot;scratch/dacapo-latency-*.csv&quot;
</code></pre>
<h4 id="keys-2"><a class="header" href="#keys-2">Keys</a></h4>
<p><code>patterns</code>: a list of patterns following the Python 3 <code>pathlib.Path.glob</code> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path.glob">syntax</a>.
Files matched the patterns will be copied to <code>LOG_DIR</code> where different subfolders will be created for each invocation.</p>
<p><code>skip_failed</code>: don't copy files from failed runs. The default value is true.</p>
<h2 id="interpreting-the-outputs"><a class="header" href="#interpreting-the-outputs">Interpreting the Outputs</a></h2>
<p>Under construction 🚧.</p>
<h3 id="console-outputs"><a class="header" href="#console-outputs">Console Outputs</a></h3>
<h3 id="log-directory"><a class="header" href="#log-directory">Log directory</a></h3>
<h2 id="heap-size-calculations"><a class="header" href="#heap-size-calculations">Heap Size Calculations</a></h2>
<p>Please refer to the source code like <a href="https://github.com/anupli/running-ng/blob/master/running/command/runbms.py#L47">here</a> and <a href="https://github.com/anupli/running-ng/blob/master/running/command/fillin.py#L5">here</a> for the actual algorithm.</p>
<p>But the basic idea is as follow.
First, we start with the ends and the middle and gradually fill the gap.
This is to make sure you can see the big picture trend.
Second, the difference between sizes are smaller for smaller sizes and larger for large sizes, because the performance is much more sensitive to the change in heap sizes when the heap is small.</p>
<h2 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h2>
<p>Under construction 🚧.</p>
<h3 id="continuously-monitor-your-experiments"><a class="header" href="#continuously-monitor-your-experiments">Continuously Monitor Your Experiments</a></h3>
<p>The results are <code>rsync</code>ed to <code>remote_host</code> once all invocations for a benchmark at a heap size are finished.
You shouldn't log into the experiment machine so not to disturb the experiments.
You should log into the remote host and check the <code>LOG_DIR</code> there and see the new results that came in.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../commands/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../commands/minheap.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../commands/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../commands/minheap.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
